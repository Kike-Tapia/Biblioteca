<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de Gestión de Biblioteca - PWA">
    <meta name="theme-color" content="#6366f1">
    <title>Biblioteca PWA - Inicio</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page" class="page active">
        <header class="hero-header">
            <div class="hero-content">
                <div class="logo-container">
                    <svg class="main-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <rect x="20" y="15" width="60" height="70" rx="3" fill="#6366f1"/>
                        <line x1="30" y1="25" x2="70" y2="25" stroke="#ffffff" stroke-width="2"/>
                        <line x1="30" y1="35" x2="70" y2="35" stroke="#ffffff" stroke-width="2"/>
                        <line x1="30" y1="45" x2="70" y2="45" stroke="#ffffff" stroke-width="2"/>
                        <line x1="30" y1="55" x2="60" y2="55" stroke="#ffffff" stroke-width="2"/>
                        <circle cx="50" cy="10" r="8" fill="#fbbf24"/>
                    </svg>
                </div>
                <h1 class="hero-title">Sistema de Gestión de Biblioteca</h1>
                <p class="hero-subtitle">Administra tu biblioteca de forma eficiente y sin conexión</p>
                <div class="hero-features">
                    <div class="feature-item">
                        <svg class="feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        <span>Funciona Offline</span>
                    </div>
                    <div class="feature-item">
                        <svg class="feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 11l3 3L22 4M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                        </svg>
                        <span>Gestión Completa</span>
                    </div>
                    <div class="feature-item">
                        <svg class="feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                        </svg>
                        <span>Notificaciones Push</span>
                    </div>
                </div>
                <button class="btn-primary" onclick="showLogin()">Abrir Panel de Control</button>
            </div>
        </header>
    </div>

    <!-- Login Page -->
    <div id="login-page" class="page">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <svg class="login-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <rect x="20" y="15" width="60" height="70" rx="3" fill="#6366f1"/>
                        <line x1="30" y1="25" x2="70" y2="25" stroke="#ffffff" stroke-width="2"/>
                        <line x1="30" y1="35" x2="70" y2="35" stroke="#ffffff" stroke-width="2"/>
                        <line x1="30" y1="45" x2="70" y2="45" stroke="#ffffff" stroke-width="2"/>
                    </svg>
                    <h2>Iniciar Sesión</h2>
                </div>
                <form id="login-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="username">
                            <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                            Usuario
                        </label>
                        <input type="text" id="username" name="username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="password">
                            <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            Contraseña
                        </label>
                        <input type="password" id="password" name="password" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn-primary btn-block">Ingresar</button>
                </form>
                <div class="login-footer">
                    <button class="btn-link" onclick="showLanding()">Volver al inicio</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Panel de Administración -->
    <div id="admin-page" class="page">
        <header class="app-header">
            <div class="header-content">
                <h1>
                    <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>
                        <line x1="9" y1="7" x2="15" y2="7"/>
                        <line x1="9" y1="11" x2="15" y2="11"/>
                        <line x1="9" y1="15" x2="13" y2="15"/>
                    </svg>
                    Panel de Administración - Biblioteca
                </h1>
                <div class="header-actions">
                    <button class="btn-icon" onclick="showNotifications()" title="Notificaciones" id="notifications-btn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                        </svg>
                        <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                    </button>
                    <span class="user-info" id="user-display"></span>
                    <button class="btn-icon" onclick="logout()" title="Cerrar Sesión">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16 17 21 12 16 7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- Navegación de Módulos -->
            <nav class="module-nav">
                <button class="module-tab active" onclick="showModule('libros')" data-module="libros">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>
                        <line x1="9" y1="7" x2="15" y2="7"/>
                        <line x1="9" y1="11" x2="15" y2="11"/>
                        <line x1="9" y1="15" x2="13" y2="15"/>
                    </svg>
                    Libros
                </button>
                <button class="module-tab" onclick="showModule('calificaciones')" data-module="calificaciones">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                    </svg>
                    Calificaciones
                </button>
            </nav>

            <!-- Módulo de Libros -->
            <div id="libros-module" class="module-content active">
                <div class="toolbar">
                    <button class="btn-primary" onclick="openLibroModal()">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Nuevo Libro
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" id="search-libros" placeholder="Buscar libros..." oninput="filterLibros()">
                    </div>
                </div>

                <div class="table-container">
                    <table id="libros-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Título</th>
                                <th>Autor</th>
                                <th>Fecha Publicación</th>
                                <th>Reseña</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="libros-tbody">
                            <!-- Los libros se cargarán aquí -->
                        </tbody>
                    </table>
                    <div id="empty-libros" class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>
                            <line x1="9" y1="7" x2="15" y2="7"/>
                            <line x1="9" y1="11" x2="15" y2="11"/>
                        </svg>
                        <p>No hay libros registrados</p>
                        <button class="btn-primary" onclick="openLibroModal()">Crear Primer Libro</button>
                    </div>
                </div>
            </div>

            <!-- Módulo de Calificaciones -->
            <div id="calificaciones-module" class="module-content">
                <div class="toolbar">
                    <button class="btn-primary" onclick="openCalificacionModal()">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Nueva Calificación
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" id="search-calificaciones" placeholder="Buscar calificaciones..." oninput="filterCalificaciones()">
                    </div>
                </div>

                <div class="table-container">
                    <table id="calificaciones-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Libro</th>
                                <th>Calificación</th>
                                <th>Reseña</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="calificaciones-tbody">
                            <!-- Las calificaciones se cargarán aquí -->
                        </tbody>
                    </table>
                    <div id="empty-calificaciones" class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                        <p>No hay calificaciones registradas</p>
                        <button class="btn-primary" onclick="openCalificacionModal()">Crear Primera Calificación</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Crear/Editar Libro -->
    <div id="libro-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="libro-modal-title">Nuevo Libro</h2>
                <button class="btn-icon" onclick="closeLibroModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <form id="libro-form" onsubmit="saveLibro(event)">
                <input type="hidden" id="libro-id">
                <div class="form-group">
                    <label for="titulo">Título *</label>
                    <input type="text" id="titulo" required maxlength="100">
                </div>
                <div class="form-group">
                    <label for="autor">Autor *</label>
                    <input type="text" id="autor" required maxlength="100">
                </div>
                <div class="form-group">
                    <label for="fechaPublicacion">Fecha de Publicación *</label>
                    <input type="date" id="fechaPublicacion" required>
                </div>
                <div class="form-group">
                    <label for="resena">Reseña *</label>
                    <textarea id="resena" rows="5" required maxlength="1000"></textarea>
                </div>
                <div class="form-group">
                    <label for="portada">Portada (opcional)</label>
                    <input type="file" id="portada" accept="image/*" onchange="handlePortadaChange(event)">
                    <div id="portada-preview" style="margin-top: 1rem; display: none;">
                        <img id="portada-img" src="" alt="Vista previa" style="max-width: 200px; max-height: 200px; border-radius: 0.5rem;">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeLibroModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Crear/Editar Calificación -->
    <div id="calificacion-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="calificacion-modal-title">Nueva Calificación</h2>
                <button class="btn-icon" onclick="closeCalificacionModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <form id="calificacion-form" onsubmit="saveCalificacion(event)">
                <input type="hidden" id="calificacion-id">
                <div class="form-group">
                    <label for="calificacion-libro">Libro *</label>
                    <select id="calificacion-libro" required>
                        <option value="">Seleccione un libro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="calificacion-valor">Calificación *</label>
                    <select id="calificacion-valor" required>
                        <option value="">Seleccione una calificación</option>
                        <option value="1">1 - Muy malo</option>
                        <option value="2">2 - Malo</option>
                        <option value="3">3 - Regular</option>
                        <option value="4">4 - Bueno</option>
                        <option value="5">5 - Excelente</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="calificacion-resena">Reseña *</label>
                    <textarea id="calificacion-resena" rows="4" required maxlength="500"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeCalificacionModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Panel de Notificaciones -->
    <div id="notifications-panel" class="notifications-panel">
        <div class="notifications-header">
            <h3>Notificaciones</h3>
            <button class="btn-icon" onclick="closeNotifications()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="notifications-list" id="notifications-list">
            <!-- Las notificaciones se cargarán aquí -->
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
